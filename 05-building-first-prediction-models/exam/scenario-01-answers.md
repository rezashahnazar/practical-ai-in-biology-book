# آزمون فصل ۵: سناریو ۱ - پاسخنامه و تحلیل (اکتشاف و آماده‌سازی داده‌ها)

[← سناریو ۱: سوالات](./scenario-01-questions.md) | [سناریو ۲: سوالات →](./scenario-02-questions.md)

در این بخش، کد کامل برای حل مسئله آماده‌سازی داده‌ها به همراه توضیحات هر مرحله ارائه می‌شود. این فرآیند، پایه و اساس هر پروژه علم داده موفقی است.

### کد کامل راه‌حل

```python
import pandas as pd
import io

# داده‌های خام ورودی
raw_data = """id,diagnosis,radius_mean,texture_mean,perimeter_mean,area_mean
842302,M,17.99,10.38,122.8,1001.0
842517,Malignant,20.57,17.77,132.9,1326.0
84300903,B,19.69,21.25,130.0,1203.0
84348301,B,11.42,20.38,77.58,386.1
84358402,B,20.29,14.34,135.1,
843786,M,12.45,15.7,82.57,477.1
"""

# -----------------------------------------------------
# مرحله ۱: خواندن داده‌ها
# -----------------------------------------------------
# استفاده از io.StringIO برای اینکه پانداز بتواند رشته را مانند یک فایل بخواند
df = pd.read_csv(io.StringIO(raw_data))

# -----------------------------------------------------
# مرحله ۲: بررسی اولیه (این بخش در کدنویسی نهایی معمولاً حذف می‌شود)
# -----------------------------------------------------
# print("--- بررسی اولیه داده‌ها ---")
# df.info()
# خروجی این دستور نشان می‌دهد که ستون area_mean یک مقدار null دارد.

# -----------------------------------------------------
# مرحله ۳: پاک‌سازی داده‌ها
# -----------------------------------------------------

# ۳.۱: پر کردن مقادیر گمشده
# ابتدا میانگین مقادیر موجود در ستون را محاسبه می‌کنیم
mean_area = df['area_mean'].mean()
# سپس با استفاده از fillna، مقدار NaN را با میانگین جایگزین می‌کنیم
df['area_mean'].fillna(mean_area, inplace=True)

# ۳.۲: استانداردسازی ستون هدف
# تمام مقادیر 'Malignant' را به 'M' تغییر می‌دهیم
df['diagnosis'].replace('Malignant', 'M', inplace=True)

# ۳.۳: تبدیل ستون هدف به عدد
# با استفاده از متد .map() یک ستون جدید عددی ایجاد می‌کنیم
df['diagnosis_numeric'] = df['diagnosis'].map({'M': 1, 'B': 0})

# -----------------------------------------------------
# مرحله ۴: جداسازی نهایی
# -----------------------------------------------------

# ۴.۱: حذف ستون‌های غیرضروری
# ستون‌های 'id' و 'diagnosis' دیگر برای مدل‌سازی لازم نیستند
df_cleaned = df.drop(columns=['id', 'diagnosis'])

# ۴.۲: تقسیم به ویژگی‌ها (X) و هدف (y)
X = df_cleaned.drop(columns=['diagnosis_numeric'])
y = df_cleaned['diagnosis_numeric']

# -----------------------------------------------------
# چاپ خروجی نهایی برای بررسی
# -----------------------------------------------------
print("--- ماتریس ویژگی‌ها (X) ---")
print(X)
print("\n--- بردار هدف (y) ---")
print(y)
```

### تحلیل و توضیح کد

#### مرحله ۱: خواندن داده‌ها

- `io.StringIO(raw_data)`: این یک تکنیک مفید برای شبیه‌سازی خواندن از فایل است. ما رشته چندخطی خود را به یک شیء تبدیل می‌کنیم که `pandas` فکر می‌کند یک فایل متنی واقعی است.
- `pd.read_csv(...)`: این تابع قدرتمند، داده‌های متنی را به یک دیتافریم پانداز منظم تبدیل می‌کند و به طور خودکار هدر (نام ستون‌ها) را تشخیص می‌دهد.

#### مرحله ۳: پاک‌سازی داده‌ها

- **`df['area_mean'].mean()`**: پانداز به سادگی میانگین تمام مقادیر عددی موجود در یک ستون (Series) را محاسبه می‌کند و مقادیر غیرعددی یا گمشده را نادیده می‌گیرد.
- **`fillna(mean_area, inplace=True)`**: متد `fillna` تمام مقادیر `NaN` در ستون را با مقدار داده شده (در اینجا `mean_area`) جایگزین می‌کند. آرگومان `inplace=True` باعث می‌شود تغییرات مستقیماً روی دیتافریم `df` اعمال شود و نیازی به ساخت یک دیتافریم جدید نباشد.
- **`replace('Malignant', 'M', ...)`**: این متد برای جایگزینی یک مقدار خاص با مقداری دیگر در یک ستون استفاده می‌شود.
- **`map({'M': 1, 'B': 0})`**: متد `.map()` یک دیکشنری به عنوان ورودی می‌گیرد و هر کلید در ستون را با مقدار متناظرش در دیکشنری جایگزین می‌کند. این یک راه بسیار خوانا و کارآمد برای تبدیل داده‌های دسته‌ای به عددی است.

#### مرحله ۴: جداسازی نهایی

- **`df.drop(columns=[...])`**: این متد برای حذف ستون‌ها (یا سطرها) از یک دیتافریم استفاده می‌شود. ما لیستی از نام ستون‌هایی که دیگر به آنها نیاز نداریم (`id` و `diagnosis` اصلی) را به آن می‌دهیم.
- **جداسازی `X` و `y`**: این یک الگوی استاندارد در `scikit-learn` است.
  - برای ساخت `X` (ماتریس ویژگی‌ها)، ما ستون هدف (`diagnosis_numeric`) را از دیتافریم پاک‌شده حذف می‌کنیم.
  - برای ساخت `y` (بردار هدف)، ما فقط همان ستون `diagnosis_numeric` را انتخاب می‌کنیم.

اکنون داده‌های ما کاملاً تمیز، عددی و در فرمت استاندارد `X` و `y` قرار دارند و برای ورود به مراحل بعدی (تقسیم و آموزش مدل) آماده هستند.
