# آزمون فصل ۵: سناریو ۴ - بهینه‌سازی مدل: تاثیر هایپرپارامتر K

[→ سناریو ۳: سوالات](./scenario-03-questions.md) | [پاسخنامه سناریو ۴](./scenario-04-answers.md)

### صورت مسئله

شما یک مدل اولیه ساخته‌اید، اما می‌دانید که عملکرد آن به شدت به تنظیمات داخلی الگوریتم بستگی دارد. این تنظیمات که قبل از آموزش مدل توسط ما انتخاب می‌شوند، **هایپرپارامتر (Hyperparameter)** نامیده می‌شوند. برای الگوریتم `KNeighborsClassifier`، مهم‌ترین هایپرپارامتر `n_neighbors` یا همان `K` است.

انتخاب `K` یک توازن است. `K` خیلی کوچک مدل را به نویز حساس می‌کند (بیش‌برازش). `K` خیلی بزرگ ممکن است الگوهای محلی مهم را نادیده بگیرد (کم‌برازش).

**وظیفه شما:**
تاثیر مقادیر مختلف `K` را بر عملکرد مدل `KNN` برای تشخیص سرطان بررسی کنید. شما سه مدل با سه مقدار مختلف `K` را آموزش داده و ارزیابی خواهید کرد تا ببینید کدام یک بهترین عملکرد را دارد.

### داده‌های آماده

ما از یک زیرمجموعه بزرگتر و واقع‌گرایانه‌تر از داده‌های سرطان سینه استفاده می‌کنیم تا نتایج قابل اعتمادتری بگیریم. اسکریپت خود را با این کد شروع کنید:

```python
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.neighbors import KNeighborsClassifier
from sklearn.metrics import recall_score
from sklearn.datasets import load_breast_cancer

# بارگذاری مجموعه داده کامل از scikit-learn
cancer = load_breast_cancer()
X = pd.DataFrame(cancer.data, columns=cancer.feature_names)
y = pd.Series(cancer.target)

# برای سادگی، فقط از ۵ ویژگی استفاده می‌کنیم
features_to_use = ['mean radius', 'mean texture', 'mean perimeter', 'mean area', 'mean smoothness']
X = X[features_to_use]
```

### الزامات اسکریپت

1.  **تقسیم داده‌ها:** داده‌های `X` و `y` را با استفاده از `train_test_split` به مجموعه‌های آموزش و آزمون تقسیم کنید. از `test_size=0.3` و `random_state=42` استفاده کنید.

2.  **آموزش و ارزیابی سه مدل:**
    - یک لیست از مقادیر `K` برای آزمایش تعریف کنید: `k_values = [1, 5, 21]`
    - یک حلقه `for` بنویسید که به ازای هر مقدار `k` در `k_values`، کارهای زیر را انجام دهد:
      a. یک مدل `KNeighborsClassifier` با `n_neighbors` برابر با `k` فعلی نمونه‌سازی کند.
      b. مدل را روی داده‌های **آموزش** (`X_train`, `y_train`) آموزش دهد.
      c. پیش‌بینی‌ها را روی داده‌های **آزمون** (`X_test`) انجام دهد.
      d. **فقط معیار Recall** را برای پیش‌بینی‌ها محاسبه کند (با توجه به اهمیت آن در تشخیص سرطان).
      e. مقدار `k` و امتیاز Recall متناظر با آن را چاپ کند.

### سوالات تحلیلی

پس از اجرای کد:

1.  کدام مقدار `K` منجر به بالاترین امتیاز **Recall** شده است؟
2.  **تفکر مفهومی:**
    - چرا `K=1` ممکن است یک انتخاب پرخطر باشد؟ (به تاثیر یک نمونه داده پرت یا دارای برچسب اشتباه در مجموعه آموزش فکر کنید).
    - چرا یک `K` بسیار بزرگ (مثلاً `K` نزدیک به تعداد کل نمونه‌های آموزشی) می‌تواند توانایی مدل در تشخیص الگوهای پیچیده را از بین ببرد؟

### خروجی مورد انتظار

اسکریپت شما باید **دقیقا** سه خط خروجی زیر را تولید کند:

```
Recall for K=1: 0.92
Recall for K=5: 0.95
Recall for K=21: 0.95
```

_(توجه: در این مثال، K=5 و K=21 نتایج یکسانی دارند، اما در مسائل دیگر ممکن است تفاوت بیشتری دیده شود. مهم درک فرآیند آزمایش است.)_
