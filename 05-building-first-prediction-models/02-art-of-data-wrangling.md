[โ ุจุฎุด ต-ฑ: ฺฉุชุงุจุฎุงููโูุง ูุฏุฑุชููุฏ: NumPyุ Pandas ู Scikit-learn](./01-powerful-libraries-numpy-pandas-sklearn.md) | [ุจุฎุด ต-ณ: ุงููู ูุฏู ุทุจููโุจูุฏ ุดูุง: ุงูฺฏูุฑุชู K-ูุฒุฏฺฉโุชุฑู ููุณุงู (KNN) โ](./03-first-classification-model-knn.md)

# ูุตู ต: ุณุงุฎุช ุงููู ูุฏูโูุง ูพุดโุจู: ุงุฒ ุฏุงุฏู ุชุง ุชุดุฎุต

## ุจุฎุด ต-ฒ: ููุฑ ุขูุงุฏูโุณุงุฒ: ุฑุงู ฺฉุฑุฏู ุฏุงุฏูโูุง ุฒุณุช

ฺฉ ุงุตู ุงุณุงุณ ุฏุฑ ุนูู ุฏุงุฏู ูุฌูุฏ ุฏุงุฑุฏ: **"ุขุดุบุงู ูุฑูุฏุ ุขุดุบุงู ุฎุฑูุฌ" (Garbage In, Garbage Out)**. ุดูุง ูโุชูุงูุฏ ุจูุชุฑู ุงูฺฏูุฑุชู ููุด ูุตููุน ุฏูุง ุฑุง ุฏุฑ ุงุฎุชุงุฑ ุฏุงุดุชู ุจุงุดุฏุ ุงูุง ุงฺฏุฑ ุฏุงุฏูโูุง ฺฉู ุจู ุขู ูโุฏูุฏ ฺฉุซูุ ูุงูุต ุง ูุงูุฑุชุจ ุจุงุดูุฏุ ูุชุงุฌ ุดูุง ุจโุงุฑุฒุด ุฎูุงููุฏ ุจูุฏ. ุฏุฑ ุงู ุจุฎุดุ ุจู ุณุฑุงุบ ฺฉ ุงุฒ ูููโุชุฑู ู ุฏุฑ ุนู ุญุงู ูพุฑฺุงูุดโุชุฑู ูุฑุงุญู ุนูู ุฏุงุฏูุ ุนู ุขูุงุฏูโุณุงุฒ ุฏุงุฏูุ ูโุฑูู.

### ๐ฏ ูุณุฆูู ูุญูุฑ: ฺฺฏููู ูโุชูุงูู ุฏุงุฏูโูุง "ูุญุด" ู ูุงูุฑุชุจ ุฒุณุช ุฑุง ุจุฑุง ุชุญูู ููุดููุฏุ "ุฑุงู" ู ุขูุงุฏู ฺฉููุ

ุฏุงุฏูโูุง ุฒุณุช ุฏุฑ ุฏูุง ูุงูุนุ ูุงููุฏ ูููููโูุง ุฌูุนโุขูุฑ ุดุฏู ุงุฒ ุทุจุนุชุ ุจู ูุฏุฑุช ุชูุฒ ู ฺฉุฏุณุช ูุณุชูุฏ. ุฏุฑ ฺฉ ุฌุฏูู ุงุทูุงุนุงุช ุจูุงุฑุงูุ ููฺฉู ุงุณุช ุณู ฺฉ ูุฑุฏ ุซุจุช ูุดุฏู ุจุงุดุฏุ ุฌูุณุช ุจุง ูุฑูุชโูุง ูุฎุชูู (M, Male, m) ูุงุฑุฏ ุดุฏู ุจุงุดุฏุ ู ูุชุงุฌ ุขุฒูุงุดฺฏุงู ุจู ุตูุฑุช ูุชู ู ุนุฏุฏ ุจุง ูู ุชุฑฺฉุจ ุดุฏู ุจุงุดูุฏ. ฺฉ ูุฏู ุงุฏฺฏุฑ ูุงุดูุ ุฏุฑุณุช ูุงููุฏ ฺฉ ุงุจุฒุงุฑ ุขุฒูุงุดฺฏุงู ุฏููุ ุจู ูุฑูุฏโูุง ุงุณุชุงูุฏุงุฑุฏ ู ุชูุฒ ูุงุฒ ุฏุงุฑุฏ. ฺฺฏููู ูโุชูุงูู ุงู ุฏุงุฏูโูุง ุฎุงู ู ูพุฑ ุงุฒ ุฎุทุง ุฑุง ุจู ฺฉ ูุฌููุนู ุฏุงุฏูโ ุณุงุฎุชุงุฑุงูุชูุ ฺฉุงูู ู ุชูุงูุงู ุนุฏุฏ ุชุจุฏู ฺฉูู ฺฉู ุจุฑุง ุขููุฒุด ฺฉ ูุฏู ูพุดโุจูโฺฉููุฏู ุขูุงุฏู ุจุงุดุฏุ ุงู ูุฑุขูุฏุ ฺฉู ุจู ุขู "ุขูุงุฏูโุณุงุฒ ุฏุงุฏู" ูโฺฏููุฏุ ุดุงุฏ ุฌุฐุงุจโุชุฑู ุจุฎุด ฺฉุงุฑ ูุจุงุดุฏุ ุงูุง ุจุฏูู ุดฺฉ ูููโุชุฑู ุขู ุงุณุช.

---

ุฏุฑ ุฏูุง ูุงูุนุ ุฏุงุฏูโูุง ุฒุณุช ุชูุฑุจุงู ูุฑฺฏุฒ ุจโููุต ูุณุชูุฏ. ููุดู ููุงุฏุฑ ฺฏูุดุฏูุ ุฎุทุงูุง ูุฑูุฏ ุฏุงุฏูุ ุง ูุฑูุชโูุง ูุงุณุงุฒฺฏุงุฑ ูุฌูุฏ ุฏุงุฑูุฏ. ุชุฎูู ุฒุฏู ูโุดูุฏ ฺฉู ุฏุงูุดููุฏุงู ุฏุงุฏู ุชุง ธฐูช ุงุฒ ุฒูุงู ุฎูุฏ ุฑุง ุตุฑู ุชูุฒ ฺฉุฑุฏู ู ุขูุงุฏูโุณุงุฒ ุฏุงุฏูโูุง ูโฺฉููุฏุ ูู ุณุงุฎุชู ูุฏู.

### ฺฉ ููููู ุฏุงุฏู ฺฉุซู

ุจุงุฏ ุจุง ฺฉ ุฏุชุงูุฑู `pandas` ฺฉุงุฑ ุฑุง ุดุฑูุน ฺฉูู ฺฉู ูููููโุง ฺฉูฺฺฉ ุงุฒ ุฏุงุฏูโูุง ุจูุงุฑุงู ุจุง ูุดฺฉูุงุช ุฑุงุฌ ุงุณุช.

```python
import pandas as pd
import numpy as np

# ุณุงุฎุช ุฏุชุงูุฑู ุจุง ุฏุงุฏูโูุง ฺฉุซู
data = {
    'PatientID': ['P001', 'P002', 'P003', 'P004', 'P005'],
    'Age': [45, 62, np.nan, 38, 55], # np.nan ฺฉ ููุฏุงุฑ ฺฏูุดุฏู ุงุณุช
    'Sex': ['F', 'M', 'F', 'M', 'Female'], # ููุงุฏุฑ ูุงุณุงุฒฺฏุงุฑ
    'Gene_Expression': [12.5, 21.0, 9.7, 15.2, 22.1],
    'Diagnosis': ['Cancer', 'Healthy', 'Cancer', 'Healthy', 'Cancer']
}
df = pd.DataFrame(data)

print("ุฏุชุงูุฑู ุงููู:")
print(df)
```

### ูุฑุงุญู ูพุงฺฉโุณุงุฒ ุฏุงุฏูโูุง

ูุง ูุฏู ุจู ูุฏู ูุดฺฉูุงุช ุงู ุฏุชุงูุฑู ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ `pandas` ุญู ุฎูุงูู ฺฉุฑุฏ.

#### ฑ. ุฑุณุฏฺฏ ุจู ููุงุฏุฑ ฺฏูุดุฏู (Missing Values)

ุงููู ูุดฺฉูุ ููุฏุงุฑ `NaN` (Not a Number) ุฏุฑ ุณุชูู `Age` ุงุณุช. ูุง ุฏู ุฑุงู ุงุตู ุฏุงุฑู: ุญุฐู ุณุทุฑ ุง ุฌุงฺฏุฒู ููุฏุงุฑ. ุงุฒ ุขูุฌุง ฺฉู ุฏุงุฏูโูุง ูุง ฺฉู ูุณุชูุฏุ ุญุฐู ุณุทุฑ ุงุฏู ุฎูุจ ูุณุช. ุจู ุฌุง ุขูุ ููุฏุงุฑ ฺฏูุดุฏู ุฑุง ุจุง **ูุงูฺฏู ุณู** ุจูู ุจูุงุฑุงู ูพุฑ ูโฺฉูู.

```python
# ูุญุงุณุจู ูุงูฺฏู ุณุชูู Age
mean_age = df['Age'].mean()

# ูพุฑ ฺฉุฑุฏู ููุงุฏุฑ NaN ุจุง ูุงูฺฏู
df['Age'].fillna(mean_age, inplace=True)

print("\nุฏุชุงูุฑู ูพุณ ุงุฒ ูพุฑ ฺฉุฑุฏู ููุงุฏุฑ ฺฏูุดุฏู:")
print(df)
```

**ูฺฉุชู:** `inplace=True` ุจู `pandas` ูโฺฏูุฏ ฺฉู ุชุบุฑุงุช ุฑุง ูุณุชููุงู ุฑู ุฏุชุงูุฑู ุงุตู ุงุนูุงู ฺฉูุฏ.

#### ฒ. ุงุณุชุงูุฏุงุฑุฏุณุงุฒ ุฏุงุฏูโูุง ุฏุณุชูโุง (Categorical Data)

ูุดฺฉู ุจุนุฏุ ุณุชูู `Sex` ุงุณุช ฺฉู ููุงุฏุฑ `F`, `M`, ู `Female` ุฑุง ุฏุงุฑุฏ. ูุง ุจุงุฏ ุงู ููุงุฏุฑ ุฑุง ฺฉูพุงุฑฺู ฺฉูู. ูุง ุชุตูู ูโฺฏุฑู ฺฉู ููู ุฑุง ุจู `F` ู `M` ุชุจุฏู ฺฉูู.

```python
# ุฌุงฺฏุฒู 'Female' ุจุง 'F'
df['Sex'].replace('Female', 'F', inplace=True)

print("\nุฏุชุงูุฑู ูพุณ ุงุฒ ุงุณุชุงูุฏุงุฑุฏุณุงุฒ ุณุชูู Sex:")
print(df)
```

#### ณ. ุชุจุฏู ุฏุงุฏูโูุง ุจุฑุง ูุฏู (Feature Engineering)

ูุฏูโูุง ุงุฏฺฏุฑ ูุงุดู ุจุง ุงุนุฏุงุฏ ฺฉุงุฑ ูโฺฉููุฏุ ูู ุจุง ูุชู. ุจูุงุจุฑุงูุ ูุง ุจุงุฏ ุณุชููโูุง ุบุฑุนุฏุฏ ุฎูุฏ (`Sex` ู `Diagnosis`) ุฑุง ุจู ูุฑูุช ุนุฏุฏ ุชุจุฏู ฺฉูู.

ุจุฑุง ุณุชูู `Diagnosis` ฺฉู ูุฏู ูุงุณุชุ ูโุชูุงูู ุจู ุณุงุฏฺฏ ุงุฒ ฺฉ ุฌุงฺฏุฒู ุฏุณุช ุงุณุชูุงุฏู ฺฉูู: `Healthy` ุจู `0` ู `Cancer` ุจู `1`.

```python
# ุชุจุฏู ุณุชูู ูุฏู (Diagnosis)
df['Diagnosis'].replace({'Healthy': 0, 'Cancer': 1}, inplace=True)
```

ุจุฑุง ุณุชูู `Sex`ุ ฺฉู ฺฉ ุงุฒ ูฺฺฏโูุง ูุฑูุฏ (feature) ูุงุณุชุ ุงุณุชูุงุฏู ุงุฒ ฐ ู ฑ ูโุชูุงูุฏ ูุฏู ุฑุง ุจู ุงุดุชุจุงู ุจูุฏุงุฒุฏ ฺฉู M > F ุงุณุช. ุจูุชุฑู ฺฉุงุฑ ุงุณุชูุงุฏู ุงุฒ ุฑูุด **One-Hot Encoding** ุงุณุช. ุฏุฑ ุงู ุฑูุดุ ุณุชูู `Sex` ุจู ุฏู ุณุชูู ุฌุฏุฏ (`Sex_F` ู `Sex_M`) ุชุจุฏู ูโุดูุฏ ฺฉู ููุท ููุงุฏุฑ ฐ ุง ฑ ุฏุงุฑูุฏ. ฺฉุชุงุจุฎุงูู `pandas` ุงู ฺฉุงุฑ ุฑุง ุจุง ุชุงุจุน `pd.get_dummies()` ุจู ุฑุงุญุช ุงูุฌุงู ูโุฏูุฏ.

```python
# ุชุจุฏู ุณุชูู ูฺฺฏ (Sex) ุจุง One-Hot Encoding
df = pd.get_dummies(df, columns=['Sex'], drop_first=True) # drop_first=True ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุงูุฒููฺฏ

print("\nุฏุชุงูุฑู ูพุณ ุงุฒ ุชุจุฏู ููุง:")
print(df)
```

ุงฺฉููู ุชูุงู ุณุชููโูุง ูุง ุนุฏุฏ ูุณุชูุฏ!

### ุฌุฏุง ฺฉุฑุฏู ูฺฺฏโูุง (X) ู ูุฏู (y)

ุขุฎุฑู ูุฏู ุฏุฑ ุขูุงุฏูโุณุงุฒ ุฏุงุฏูโูุงุ ุฌุฏุง ฺฉุฑุฏู ุฏุชุงูุฑู ุจู ุฏู ุจุฎุด ุงุณุช:

- **`X`**: ูุงุชุฑุณ ูฺฺฏโูุง (Features). ุงููุง ุฏุงุฏูโูุง ูุฑูุฏ ูุณุชูุฏ ฺฉู ูุฏู ูุง ุจุฑุง ุงุฏฺฏุฑ ุงุฒ ุขููุง ุงุณุชูุงุฏู ูโฺฉูุฏ (ุชูุงู ุณุชููโูุง ุจู ุฌุฒ ุณุชูู ูุฏู).
- **`y`**: ุจุฑุฏุงุฑ ูุฏู (Target). ุงู ุณุชูู ุงุณุช ฺฉู ูุง ูโุฎูุงูู ูุฏู ุงุฏ ุจฺฏุฑุฏ ุขู ุฑุง ูพุดโุจู ฺฉูุฏ (`Diagnosis`).

```python
# ุณุชูู 'PatientID' ุจุฑุง ูุฏูโุณุงุฒ ูุงุฒู ูุณุชุ ูพุณ ุขู ุฑุง ุญุฐู ูโฺฉูู
X = df.drop(columns=['PatientID', 'Diagnosis'])
y = df['Diagnosis']

print("\nูุงุชุฑุณ ูฺฺฏโูุง (X):")
print(X)

print("\nุจุฑุฏุงุฑ ูุฏู (y):")
print(y)
```

ุฏุงุฏูโูุง ูุง ุงฺฉููู ฺฉุงููุงู ุชูุฒุ ุขูุงุฏู ู ุฏุฑ ูุฑูุช ุตุญุญ ุจุฑุง ูุฑูุฏ ุจู ฺฉ ูุฏู ุงุฏฺฏุฑ ูุงุดู ุฏุฑ Scikit-learn ูุณุชูุฏ.

---

### ๐ฌ ุชูุฑู ุชุญูู: ุฑุณุฏฺฏ ุจู ุฏุงุฏูโูุง ุฌุฏุฏ

ุฏุชุงูุฑู ุฒุฑ ุฑุง ุฏุฑ ูุธุฑ ุจฺฏุฑุฏ. ุงู ุฏุชุงูุฑู ุญุงู ุฏุงุฏูโูุง ุจุงู ฺู ุจุฑุง ฺูุฏ ููููู ุงุณุชุ ุงูุง ูุดฺฉูุงุช ุฎุงุต ุฎูุฏ ุฑุง ุฏุงุฑุฏ. ฺฉุฏูุง ูุงุฒู ุจุฑุง ูพุงฺฉโุณุงุฒ ู ุขูุงุฏูโุณุงุฒ ุงู ุฏุชุงูุฑู ุฑุง ุจููุณุฏ.

```python
import pandas as pd
import numpy as np

data = {
    'SampleID': ['S1', 'S2', 'S3', 'S4'],
    'Tissue_Type': ['Tumor', 'Normal', 'Tumor', 'Unknown'], # ููุฏุงุฑ ูุงูุนุชุจุฑ
    'Gene_A_Expr': [150.2, 89.9, 180.5, 165.1],
    'Gene_B_Expr': [75.6, 99.1, -1.0, 82.3], # ููุฏุงุฑ ููู ูุงูุนุชุจุฑ
    'Batch': [1, 2, 1, 2]
}
new_df = pd.DataFrame(data)
```

**ูุฑุงุญู ููุฑุฏ ูุงุฒ:**

1.  ุณุทุฑ ฺฉู ุฏุฑ ุขู `Tissue_Type` ุจุฑุงุจุฑ ุจุง `'Unknown'` ุงุณุช ุฑุง ุจู ุทูุฑ ฺฉุงูู ุญุฐู ฺฉูุฏ.
2.  ุฏุฑ ุณุชูู `Gene_B_Expr`ุ ูุฑ ููุฏุงุฑ ููู ุฑุง ุจุง ุตูุฑ ุฌุงฺฏุฒู ฺฉูุฏ (ุฒุฑุง ุจุงู ฺู ููโุชูุงูุฏ ููู ุจุงุดุฏ).
3.  ุณุชูู `Tissue_Type` ุฑุง ุจู ูุฑูุช ุนุฏุฏ ุชุจุฏู ฺฉูุฏ (`Normal`=0, `Tumor`=1).
4.  ุฏุฑ ููุงุชุ ุฏุชุงูุฑู ูพุงฺฉโุณุงุฒ ุดุฏู ุฑุง ฺุงูพ ฺฉูุฏ.

**ูพุงุณุฎ ู ุฑุงู ุญู:**

```python
# ฺฉูพ ฺฉุฑุฏู ุฏุชุงูุฑู ุงููู ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุชุบุฑ ูุงุฎูุงุณุชู
cleaned_df = new_df.copy()

# 1. ุญุฐู ุฑุฏู ุจุง ููุฏุงุฑ 'Unknown'
# ุงุจุชุฏุง ุงูุฏฺฉุณ ุฑุฏู(ูุง) ููุฑุฏ ูุธุฑ ุฑุง ูพุฏุง ูโฺฉูู
unknown_index = cleaned_df[cleaned_df['Tissue_Type'] == 'Unknown'].index
# ุณูพุณ ุขู ุฑุฏู(ูุง) ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ drop ุญุฐู ูโฺฉูู
cleaned_df.drop(unknown_index, inplace=True)

# 2. ุฌุงฺฏุฒู ููุงุฏุฑ ููู ุจุง ุตูุฑ
# ูุง ุงุฒ .loc ุจุฑุง ุงูุชุฎุงุจ ุณุทุฑูุง ู ุณุชููโูุง ุฎุงุต ุจุฑุง ุชุบุฑ ุงุณุชูุงุฏู ูโฺฉูู
cleaned_df.loc[cleaned_df['Gene_B_Expr'] < 0, 'Gene_B_Expr'] = 0

# 3. ุชุจุฏู ุณุชูู 'Tissue_Type' ุจู ุนุฏุฏ
cleaned_df['Tissue_Type'].replace({'Normal': 0, 'Tumor': 1}, inplace=True)

# 4. ฺุงูพ ูุชุฌู ููุง
print("\nุฏุชุงูุฑู ููุง ูพุงฺฉโุณุงุฒ ุดุฏู:")
print(cleaned_df)
```

### ๐ก ูฺฉุงุช ฺฉูุฏ ุงู ุจุฎุด

- **ุงุตู GIGO:** ฺฉูุช ูุฏู ููุด ูุตููุน ุดูุง ูุณุชููุงู ุจู ฺฉูุช ุฏุงุฏูโูุง ูุฑูุฏ ุจุณุชฺฏ ุฏุงุฑุฏ.
- **ููุงุฏุฑ ฺฏูุดุฏู:** ููุงุฏุฑ `NaN` ุฑุง ูโุชูุงู ุจุง ูุงูฺฏูุ ูุงูู ุง ฺฉ ููุฏุงุฑ ุซุงุจุช ูพุฑ ฺฉุฑุฏ ู ุง ุณุทุฑ ูุฑุจูุท ุจู ุขููุง ุฑุง ุญุฐู ูููุฏ.
- **ุงุณุชุงูุฏุงุฑุฏุณุงุฒ:** ุฏุงุฏูโูุง ูุชู (Categorical) ุจุงุฏ ฺฉูพุงุฑฺู ุดููุฏ (ูุซูุงู `Female` ุจู `F`).
- **ุชุจุฏู ุจู ุนุฏุฏ:** ุชูุงู ูฺฺฏโูุง ูุฑูุฏ ุจู ูุฏู ุจุงุฏ ุนุฏุฏ ุจุงุดูุฏ. ุงุฒ ุฑูุดโูุง ูุงููุฏ ุฌุงฺฏุฒู ูุณุชูู ุง **One-Hot Encoding** ุจุฑุง ุงู ฺฉุงุฑ ุงุณุชูุงุฏู ูโุดูุฏ.
- **ุฌุฏุงุณุงุฒ X ู y:** ูุจู ุงุฒ ุขููุฒุด ูุฏูุ ุจุงุฏ ูฺฺฏโูุง ูุฑูุฏ (`X`) ุงุฒ ุณุชูู ูุฏู (`y`) ุฌุฏุง ุดููุฏ.

ุขูุงุฏูโุณุงุฒ ุฏุงุฏู ฺฉ ููุงุฑุช ุญุงุช ุงุณุช. ุจุง ุฏุงุฏูโูุง ุชูุฒุ ูุง ุขูุงุฏูโุงู ุชุง ุฏุฑ ุจุฎุด ุจุนุฏ ุงููู ูุฏู ูพุดโุจูโฺฉููุฏู ุฎูุฏ ุฑุง ุจุณุงุฒู ู ุขููุฒุด ุฏูู.
