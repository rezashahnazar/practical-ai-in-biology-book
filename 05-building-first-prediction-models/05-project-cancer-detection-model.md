# ูุตู ต: ุณุงุฎุช ุงููู ูุฏูโูุง ูพุดโุจู: ุงุฒ ุฏุงุฏู ุชุง ุชุดุฎุต

## ุจุฎุด ต-ต: ูุทุงูุนู ููุฑุฏ: ุณุงุฎุช ุฎุท ูููู ุชุดุฎุต ุณุฑุทุงู ุงุฒ ุตูุฑ ุชุง ุตุฏ

[โ ุจุฎุด ต-ด: ูุฏู ูุง ฺูุฏุฑ ุฎูุจ ฺฉุงุฑ ูโฺฉูุฏุ ูุนุงุฑูุง ุงุฑุฒุงุจ](./04-model-evaluation-metrics.md) | [ุขุฒููู ูุตู ูพูุฌู โ](./exam/index.md)

ุชุงฺฉูููุ ูุง ูุทุนุงุช ูุฎุชูู ฺฉ ูพุงุฒู ุฑุง ุฏุฏูโุงู: ุฎูุงูุฏู ุฏุงุฏูุ ูพุงฺฉโุณุงุฒุ ุชูุณูุ ุขููุฒุด ู ุงุฑุฒุงุจ. ุงูุง ฺฉ ุฏุงูุดููุฏ ุฏุงุฏูโ ูุงูุนุ ุงู ูุฑุงุญู ุฑุง ุจู ุนููุงู ฺฉ "ุฎุท ูููู" ุง "ฺฏุฑุฏุด ฺฉุงุฑ" (Workflow) ฺฉูพุงุฑฺู ูโุจูุฏ. ุฏุฑ ุงู ูพุฑูฺู ููุงุ ูุง ููุด ฺฉ ูููุฏุณ ุงุฏฺฏุฑ ูุงุดู ุฑุง ุจุงุฒ ูโฺฉูู ู ุชูุงู ุขููุฎุชูโูุง ุฎูุฏ ุฑุง ุจุฑุง ุณุงุฎุชู ฺฉ ุณุณุชู ฺฉุงูู ุชุดุฎุต ุณุฑุทุงูุ ุงุฒ ุงุจุชุฏุง ุชุง ุงูุชูุงุ ุจู ฺฉุงุฑ ูโฺฏุฑู. ูุฏู ูุง ุงู ุงุณุช ฺฉู ฺฉ ุงุณฺฉุฑูพุช ูุงุญุฏ ุจููุณู ฺฉู ุจู ุทูุฑ ุฎูุฏฺฉุงุฑ ุฏุงุฏูโูุง ูพุฒุดฺฉ ฺฉุซู ุฑุง ุจู ุนููุงู ูุฑูุฏ ุจฺฏุฑุฏ ู ฺฉ ฺฏุฒุงุฑุด ฺฉุงูู ุงุฒ ุนููฺฉุฑุฏ ฺฉ ูุฏู ูพุดโุจูโฺฉููุฏู ุจู ุนููุงู ุฎุฑูุฌ ุชุญูู ุฏูุฏ.

---

### ุงุณฺฉุฑูพุช ฺฉุงูู ุฏุฑ Google Colab

ฺฉุฏ ุฒุฑ ุฑุง ูโุชูุงูุฏ ุจู ุทูุฑ ฺฉุงูู ุฏุฑ ฺฉ ููุชโุจูฺฉ ุฌุฏุฏ Google Colab ฺฉูพ ู ุงุฌุฑุง ฺฉูุฏ. ุงู ฺฉุฏ ุชูุงู ูุฑุงุญูุ ุงุฒ ุฎูุงูุฏู ุฏุงุฏู ุชุง ุงุฑุฒุงุจ ููุง ุฑุง ุดุงูู ูโุดูุฏ.

```python
# ===================================================================
# ูุฑุญูู ฑ: ูุงุฑุฏ ฺฉุฑุฏู ฺฉุชุงุจุฎุงููโูุง ููุฑุฏ ูุงุฒ
# ===================================================================
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
from sklearn.neighbors import KNeighborsClassifier
from sklearn.metrics import accuracy_score, confusion_matrix, classification_report
import io

# ===================================================================
# ูุฑุญูู ฒ: ุขูุงุฏูโุณุงุฒ ุฏุงุฏูโูุง (ุดุจูโุณุงุฒ ูุงู ูุฑูุฏ)
# ===================================================================
# ุฏุฑ ฺฉ ุณูุงุฑู ูุงูุนุ ุงู ุฏุงุฏูโูุง ุงุฒ ฺฉ ูุงู CSV ุฎูุงูุฏู ูโุดูุฏ.
# ูุง ุฏุฑ ุงูุฌุง ุขู ุฑุง ุจู ุตูุฑุช ฺฉ ุฑุดุชู ุดุจูโุณุงุฒ ูโฺฉูู ุชุง ฺฉุฏ ูุงุจู ุงุฌุฑุง ุจุงุดุฏ.
csv_data = """
Biomarker1,Biomarker2,TumorSize,Diagnosis,PatientAge,Metastasis
1.2,3.4,15.5,Positive,65,Yes
0.8,2.1,12.1,Negative,45,No
,3.9,18.2,Positive,72,yes
1.5,4.5,20.0,positive,68,Yes
0.5,1.9,10.3,negative,38,no
1.9,5.1,22.5,Positive,75,YES
1.1,3.2,NaN,Positive,59,Yes
0.7,2.5,11.5,Negative,41,No
"""

# ุฎูุงูุฏู ุฏุงุฏูโูุง ุดุจูโุณุงุฒ ุดุฏู ุจู ฺฉ DataFrame ูพุงูุฏุงุฒ
df = pd.read_csv(io.StringIO(csv_data))
print("--- ุฏุงุฏูโูุง ุฎุงู ุงููู ---")
print(df)
print("\n")


# ===================================================================
# ูุฑุญูู ณ: ูพุงฺฉโุณุงุฒ ู ุขูุงุฏูโุณุงุฒ ุฏุงุฏูโูุง (Data Cleaning)
# ===================================================================

# ณ.ฑ: ูพุฑ ฺฉุฑุฏู ููุงุฏุฑ ฺฏูุดุฏู (NaN) ุจุง ูุงูฺฏู ุณุชูู
df['Biomarker1'].fillna(df['Biomarker1'].mean(), inplace=True)
df['TumorSize'].fillna(df['TumorSize'].mean(), inplace=True)

# ณ.ฒ: ุงุณุชุงูุฏุงุฑุฏ ฺฉุฑุฏู ููุงุฏุฑ ุณุชููโูุง ูุชู
df['Diagnosis'] = df['Diagnosis'].str.lower()
df['Metastasis'] = df['Metastasis'].str.lower()

# ณ.ณ: ุชุจุฏู ุณุชููโูุง ูุชู ุจู ุนุฏุฏ
# Diagnosis: positive -> 1, negative -> 0
df['Diagnosis_numeric'] = df['Diagnosis'].apply(lambda x: 1 if x == 'positive' else 0)
# Metastasis: yes -> 1, no -> 0
df['Metastasis_numeric'] = df['Metastasis'].apply(lambda x: 1 if x == 'yes' else 0)

# ุญุฐู ุณุชููโูุง ูุชู ุงุตู
df_cleaned = df.drop(['Diagnosis', 'Metastasis'], axis=1)

print("--- ุฏุงุฏูโูุง ูพุงฺฉโุณุงุฒ ุดุฏู ู ุนุฏุฏ ---")
print(df_cleaned)
print("\n")


# ===================================================================
# ูุฑุญูู ด: ุฌุฏุงุณุงุฒ ูฺฺฏโูุง (X) ู ูุฏู (y)
# ===================================================================
X = df_cleaned.drop('Diagnosis_numeric', axis=1)
y = df_cleaned['Diagnosis_numeric']

print("--- ูฺฺฏโูุง (X) ---")
print(X.head())
print("\n--- ูุฏู (y) ---")
print(y.head())
print("\n")


# ===================================================================
# ูุฑุญูู ต: ุชูุณู ุฏุงุฏูโูุง ุจู ูุฌููุนู ุขููุฒุด ู ุขุฒููู
# ===================================================================
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)
print(f"ุชุนุฏุงุฏ ูููููโูุง ุขููุฒุด: {len(X_train)}")
print(f"ุชุนุฏุงุฏ ูููููโูุง ุขุฒููู: {len(X_test)}")
print("\n")


# ===================================================================
# ูุฑุญูู ถ: ุณุงุฎุชุ ุขููุฒุด ู ูพุดโุจู ุจุง ูุฏู KNN
# ===================================================================
# ููุฏุงุฑ K=3 ุฑุง ุงูุชุฎุงุจ ูโฺฉูู
knn_model = KNeighborsClassifier(n_neighbors=3)

# ุขููุฒุด ูุฏู ุจุง ุฏุงุฏูโูุง ุขููุฒุด
knn_model.fit(X_train, y_train)

# ูพุดโุจู ุฑู ุฏุงุฏูโูุง ุขุฒููู
predictions = knn_model.predict(X_test)

print("--- ูพุดโุจูโูุง ูุฏู ุฑู ุฏุงุฏูโูุง ุขุฒููู ---")
print("ุฏุงุฏูโูุง ูุงูุน:\t", y_test.values)
print("ูพุดโุจู ูุฏู:\t", predictions)
print("\n")


# ===================================================================
# ูุฑุญูู ท: ุงุฑุฒุงุจ ุนููฺฉุฑุฏ ูุฏู
# ===================================================================
# ท.ฑ: ูุญุงุณุจู ุฏูุช (Accuracy)
accuracy = accuracy_score(y_test, predictions)
print(f"--- ุงุฑุฒุงุจ ูุฏู ---")
print(f"ุฏูุช ฺฉู ูุฏู: {accuracy * 100:.2f}%")

# ท.ฒ: ููุงุด ูุงุชุฑุณ ุฏุฑููโุฑุฎุชฺฏ (Confusion Matrix)
cm = confusion_matrix(y_test, predictions)
plt.figure(figsize=(6, 4))
sns.heatmap(cm, annot=True, fmt='d', cmap='Blues',
            xticklabels=['ุณุงูู', 'ุณุฑุทุงู'], yticklabels=['ุณุงูู', 'ุณุฑุทุงู'])
plt.xlabel('ูพุดโุจู ูุฏู')
plt.ylabel('ุจุฑฺุณุจ ูุงูุน')
plt.title('ูุงุชุฑุณ ุฏุฑููโุฑุฎุชฺฏ')
plt.show()

# ท.ณ: ููุงุด ฺฏุฒุงุฑุด ฺฉุงูู ุทุจููโุจูุฏ (Classification Report)
report = classification_report(y_test, predictions, target_names=['ุณุงูู (0)', 'ุณุฑุทุงู (1)'])
print("\n--- ฺฏุฒุงุฑุด ฺฉุงูู ุทุจููโุจูุฏ ---")
print(report)
```

### ฺฏุฑุฏุด ฺฉุงุฑ ุฑุง ูุฑูุฑ ฺฉูู

1.  **ูุงุฑุฏ ฺฉุฑุฏู ู ุขูุงุฏูโุณุงุฒ ุฏุงุฏู (ูุฑุงุญู ฑ ู ฒ):** ูุง ุจุง ูุงุฑุฏ ฺฉุฑุฏู ฺฉุชุงุจุฎุงููโูุง ูุงุฒู ุดุฑูุน ูโฺฉูู ู ุณูพุณ ฺฉ ูุฌููุนู ุฏุงุฏู "ฺฉุซู" ุฑุง ุดุจูโุณุงุฒ ูโฺฉูู. ุงู ูุฌููุนู ุฏุงุฏู ุฏุงุฑุง ููุงุฏุฑ ฺฏูุดุฏู ู ูุฑูุชโูุง ูุชู ูุงููุงููฺฏ ุงุณุชุ ุฏููุงู ูุงููุฏ ุฏุงุฏูโูุง ุฏูุง ูุงูุน.
2.  **ูพุงฺฉโุณุงุฒ (ูุฑุญูู ณ):** ุฏุฑ ุงู ูุฑุญููุ ูุง ุจู ุทูุฑ ุณุณุชูุงุชฺฉ ูุดฺฉูุงุช ุฏุงุฏูโูุง ุฑุง ุจุฑุทุฑู ูโฺฉูู: ููุงุฏุฑ ฺฏูุดุฏู ุฑุง ุจุง ูุงูฺฏู ูพุฑ ูโฺฉููุ ูุชูโูุง ุฑุง ุจู ุญุฑูู ฺฉูฺฺฉ ุชุจุฏู ูโฺฉูู ุชุง ฺฉุณุงู ุดููุฏุ ู ุฏุฑ ููุงุช ููุงุฏุฑ ูุชู (ูุงููุฏ "positive" ู "yes") ุฑุง ุจู ูุฑูุช ุนุฏุฏ (1 ู 0) ุชุจุฏู ูโฺฉูู ฺฉู ุจุฑุง ูุฏูโูุง ุฑุงุถ ูุงุจู ููู ุจุงุดุฏ.
3.  **ุฌุฏุงุณุงุฒ ู ุชูุณู (ูุฑุงุญู ด ู ต):** ูุง ุณุชูู ูุฏู ("Diagnosis_numeric") ุฑุง ุงุฒ ูฺฺฏโูุง ุฌุฏุง ฺฉุฑุฏู ู ุณูพุณ ฺฉู ูุฌููุนู ุฏุงุฏู ุฑุง ุจู ุฏู ุจุฎุด ุขููุฒุด ู ุขุฒููู ุชูุณู ูโฺฉูู ุชุง ุจุชูุงูู ูุฏู ุฑุง ุจู ุทูุฑ ููุตูุงูู ุงุฑุฒุงุจ ฺฉูู.
4.  **ุขููุฒุด ู ูพุดโุจู (ูุฑุญูู ถ):** ุงู ููุจ ูพุฑูฺู ุงุณุช. ูุง ฺฉ ูุฏู `KNeighborsClassifier` ุฑุง ุงูุชุฎุงุจ ฺฉุฑุฏูุ ุขู ุฑุง ุจุง ุฏุงุฏูโูุง ุขููุฒุด (`X_train`, `y_train`) "fit" ูโฺฉูู ู ุณูพุณ ุงุฒ ุขู ูโุฎูุงูู ุชุง ุจุฑฺุณุจโูุง ุฏุงุฏูโูุง ุขุฒููู (`X_test`) ุฑุง ูพุดโุจู ฺฉูุฏ.
5.  **ุงุฑุฒุงุจ (ูุฑุญูู ท):** ุฏุฑ ููุงุชุ ูุง ูพุดโุจูโูุง ูุฏู ุฑุง ุจุง ูุงูุนุช (`y_test`) ููุงุณู ูโฺฉูู ู ุจุง ุงุณุชูุงุฏู ุงุฒ ูุนุงุฑูุง ุงุณุชุงูุฏุงุฑุฏ ูุงููุฏ ุฏูุชุ ูุงุชุฑุณ ุฏุฑููโุฑุฎุชฺฏ ู ฺฏุฒุงุฑุด ุทุจููโุจูุฏุ ฺฉ ูุถุงูุช ฺฉุงูู ู ุฏูู ุฏุฑ ููุฑุฏ ุนููฺฉุฑุฏ ุขู ุงุฑุงุฆู ูโุฏูู.

---

### ๐ฌ ุชูุฑู ุชุญูู: ุจูุจูุฏ ุฎุท ูููู

ุดูุง ุงฺฉููู ฺฉ ุฎุท ูููู (pipeline) ฺฉุงูู ุงุฏฺฏุฑ ูุงุดู ุฏุงุฑุฏ. ุขู ุฑุง ุจูุจูุฏ ุฏูุฏ.

**ูุธุงู:**

1.  **ุชุบุฑ ูุงูพุฑูพุงุฑุงูุชุฑ:** ููุฏุงุฑ `n_neighbors` (ููุงู `K`) ุฑุง ุฏุฑ ูุฏู KNN ุชุบุฑ ุฏูุฏ. ุขุง ุจุง `K=1` ุง `K=5` ูุชุงุฌ ุจูุชุฑ ุง ุจุฏุชุฑ ูโฺฏุฑุฏุ
2.  **ุชุบุฑ ูุณุจุช ุชูุณู:** ุฏุฑ `train_test_split`ุ ููุฏุงุฑ `test_size` ุฑุง ุงุฒ 0.3 ุจู 0.2 ุชุบุฑ ุฏูุฏ. ุงู ฺฉุงุฑ ฺู ุชุฃุซุฑ ุจุฑ ุนููฺฉุฑุฏ ูุฏู ุฏุงุฑุฏุ ุขุง ูููููโูุง ุขููุฒุด ุจุดุชุฑ ููุดู ุจูุชุฑ ุงุณุชุ
3.  **ฺุงูุด ุจุฒุฑฺฏ:** ุจู ูุณุชูุฏุงุช Scikit-learn ุจุฑูุฏ ู ฺฉ ุงูฺฏูุฑุชู ุทุจููโุจูุฏ ุฏฺฏุฑ ูุงููุฏ `LogisticRegression` ุง `DecisionTreeClassifier` ุฑุง ูพุฏุง ฺฉูุฏ. ุณุน ฺฉูุฏ ูุฏู KNN ุฑุง ุจุง ฺฉ ุงุฒ ุงู ูุฏูโูุง ุฌุงฺฏุฒู ฺฉูุฏ (ฺฉุงู ุงุณุช ฺูุฏ ุฎุท ฺฉุฏ ุฑุง ุชุบุฑ ุฏูุฏ). ุขุง ุนููฺฉุฑุฏ ุจูุชุฑ ุฏุงุฑูุฏุ

### ๐ก ูฺฉุงุช ฺฉูุฏ ุงู ุจุฎุด

- **ฺฏุฑุฏุด ฺฉุงุฑ ุณุฑุชุงุณุฑ (End-to-End Workflow):** ฺฉ ูพุฑูฺู ุนูู ุฏุงุฏู ุดุงูู ฺฉ ุฒูุฌุฑู ููุทู ุงุฒ ูุฑุงุญู ุงุณุช: ุจุงุฑฺฏุฐุงุฑุ ูพุงฺฉโุณุงุฒุ ุขูุงุฏูโุณุงุฒุ ุฌุฏุงุณุงุฒุ ุชูุณูุ ุขููุฒุดุ ูพุดโุจู ู ุงุฑุฒุงุจ.
- **ุดุจูโุณุงุฒ ุฏุงุฏู:** ุจุฑุง ุณุงุฎุช ูููููโูุง ุงููู ู ุชุณุช ฺฉุฏุ ูโุชูุงู ุฏุงุฏูโูุง ุฑุง ุจู ุตูุฑุช ุฑุดุชู ุง ุฏฺฉุดูุฑ ุฏุฑ ุฎูุฏ ุงุณฺฉุฑูพุช ุงุฌุงุฏ ฺฉุฑุฏ.
- **ุงููุช ูพุงฺฉโุณุงุฒ:** ุงู ูุทุงูุนู ููุฑุฏ ูุดุงู ุฏุงุฏ ฺฉู ุจุฎุด ูุงุจู ุชูุฌู ุงุฒ ฺฉุฏ ุจู ูุฏุฑุช ุฏุงุฏูโูุง ูุงูุต ู ูุงุณุงุฒฺฏุงุฑ ุงุฎุชุตุงุต ุฏุงุฑุฏ.
- **ุขุฒูุงุด ู ุชฺฉุฑุงุฑ:** ุนูู ุฏุงุฏู ฺฉ ูุฑุขูุฏ ุงุณุชุง ูุณุช. ุจูุชุฑู ูุชุงุฌ ุจุง ุขุฒูุงุด ูุงูพุฑูพุงุฑุงูุชุฑูุง ูุฎุชููุ ุงูฺฏูุฑุชูโูุง ฺฏููุงฺฏูู ู ุฑูุดโูุง ูุชูุงูุช ุขูุงุฏูโุณุงุฒ ุฏุงุฏู ุจู ุฏุณุช ูโุขุฏ.

ุงู ูุตู ูพุงู ู ุงุณุงุณ ุณูุฑ ุดูุง ุฏุฑ ุฏูุง ุจูุงูููุฑูุงุชฺฉ ุนูู ุฑุง ุจูุง ููุงุฏ. ุดูุง ุงฺฉููู ูโุชูุงูุฏ ุฏุงุฏูโูุง ุฑุง ูพุฑุฏุงุฒุด ฺฉูุฏุ ูุฏูโูุง ูพุดโุจูโฺฉููุฏู ุจุณุงุฒุฏ ู ุนููฺฉุฑุฏ ุขููุง ุฑุง ุจุณูุฌุฏ.
