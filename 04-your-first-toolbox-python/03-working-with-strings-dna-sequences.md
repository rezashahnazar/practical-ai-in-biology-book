[← بخش ۴-۲: متغیرها: قفسه‌هایی برای داده‌های زیستی](./02-variables-for-bio-data.md) | [بخش ۴-۴: منطق ماشین: حلقه‌ها و شرط‌ها →](./04-machine-logic-loops-and-conditions.md)

# فصل ۴: اولین جعبه ابزار شما: پایتون

## بخش ۴-۳: کار با رشته‌ها: تحلیل توالی‌های DNA و پروتئین

برای یک متخصص بیوانفورماتیک، رشته‌ها فقط یک سری کاراکتر نیستند؛ آنها نمایش دیجیتالی مولکول‌های حیات هستند. یادگیری نحوه دستکاری رشته‌ها در پایتون، معادل یادگیری تکنیک‌های پایه‌ای در یک آزمایشگاه زیست‌شناسی مولکولی است. در این بخش، ما چند عملگر و تابع کلیدی را یاد می‌گیریم که به ما اجازه می‌دهند توالی‌های DNA و پروتئین را به صورت محاسباتی تحلیل کنیم.

### 🎯 مسئله محوری: چگونه می‌توانیم یک توالی DNA دیجیتال را مانند یک زیست‌شناس در آزمایشگاه، برش دهیم، اندازه بگیریم و بررسی کنیم؟

یک توالی DNA یا پروتئین در کامپیوتر، فقط یک رشته طولانی از حروف است. اما یک زیست‌شناس به آن به چشم یک مولکول با قطعات عملکردی (اگزون، اینترون، پروموتر)، طول مشخص و ترکیبی منحصربه‌فرد از بازها نگاه می‌کند. سوال این است: چگونه می‌توانیم ابزارهای نرم‌افزاری بسازیم که این تحلیل‌های بنیادی را برای ما انجام دهند؟ چگونه می‌توانیم به کامپیوتر یاد بدهیم که طول یک ژن را محاسبه کند، یک کدون خاص را پیدا کند، یا تعداد یک نوکلئوتید را بشمارد؟ در این بخش، ما یاد می‌گیریم که چگونه با "رشته‌ها" در پایتون کار کنیم و اولین تحلیل‌های واقعی بیوانفورماتیکی خود را انجام دهیم.

---

بیایید با یک توالی DNA فرضی برای تمام مثال‌هایمان کار کنیم:

```python
# این متغیر را در یک سلول در Colab خود ایجاد و اجرا کنید تا در حافظه ذخیره شود.
dna = "AGGTCCGATAAGCTTAGGAT"
```

### ۱. پیدا کردن طول توالی (`len()`)

اولین سوالی که معمولاً در مورد یک ژن یا پروتئین می‌پرسیم این است: "طول آن چقدر است؟" تابع `len()` به ما پاسخ می‌دهد.

```python
dna_length = len(dna)
print("طول توالی DNA:", dna_length)
```

**خروجی:**
`طول توالی DNA: 20`

### ۲. دسترسی به یک نوکلئوتید خاص (Indexing)

در پایتون، کاراکترهای یک رشته از **صفر** شماره‌گذاری می‌شوند. یعنی اولین کاراکتر در جایگاه (index) صفر، دومی در جایگاه یک، و الی آخر قرار دارد. ما می‌توانیم با استفاده از `[]` به هر کاراکتر دلخواه دسترسی پیدا کنیم.

```python
first_base = dna[0]
fifth_base = dna[4]

print("اولین باز:", first_base)
print("پنجمین باز:", fifth_base)
```

**خروجی:**
`اولین باز: A`
`پنجمین باز: C`

### ۳. استخراج یک قطعه از توالی (Slicing)

این یکی از قدرتمندترین ابزارها برای تحلیل توالی است. اگر بخواهیم یک ناحیه خاص از ژن (مثلاً یک اگزون یا یک پروموتر) را استخراج کنیم، از Slicing استفاده می‌کنیم. سینتکس آن `[start:end]` است، که `start` شماره ایندکس شروع و `end` شماره ایندکس پایانی است (خود ایندکس پایانی شامل قطعه نمی‌شود).

```python
# استخراج قطعه از ایندکس 6 تا 12
promoter_region = dna[6:12]
print("ناحیه پروموتر فرضی:", promoter_region)
```

**خروجی:**
`ناحیه پروموتر فرضی: GATAAG`

### ۴. چسباندن دو توالی به هم (Concatenation)

برای اتصال دو رشته (مثلاً دو اگزون یک ژن)، ما از عملگر `+` استفاده می‌کنیم.

```python
exon1 = "ATGGCC"
exon2 = "AATTAG"
full_gene = exon1 + exon2

print("ژن کامل:", full_gene)
```

**خروجی:**
`ژن کامل: ATGGCCAATTAG`

### ۵. شمارش تعداد بازها (`.count()`)

یک کار بسیار رایج، شمارش تعداد تکرار یک باز یا یک الگوی کوتاه (motif) در یک توالی است. متد `.count()` این کار را برای ما انجام می‌دهد.

```python
# برمیگردیم به توالی dna اصلی
# dna = "AGGTCCGATAAGCTTAGGAT"

g_count = dna.count('G')
a_count = dna.count('A')
ga_motif_count = dna.count('GA')

print("تعداد گوانین (G):", g_count)
print("تعداد آدنین (A):", a_count)
print("تعداد موتیف 'GA':", ga_motif_count)
```

**خروجی:**
`تعداد گوانین (G): 6`
`تعداد آدنین (A): 6`
`تعداد موتیف 'GA': 2`

### ۶. پیدا کردن یک الگو (`.find()`)

اگر بخواهیم بدانیم یک الگوی خاص (مثلاً کدون شروع 'ATG') از کجای توالی ما شروع می‌شود، از متد `.find()` استفاده می‌کنیم. این متد، ایندکس اولین کاراکتر الگو را برمی‌گرداند. اگر الگو پیدا نشود، مقدار `-1` را برمی‌گرداند.

```python
# dna = "AGGTCCGATAAGCTTAGGAT"
# بیایید یک کدون شروع به ابتدای آن اضافه کنیم
dna_with_start = "ATG" + dna

start_codon_index = dna_with_start.find("ATG")
tata_box_index = dna_with_start.find("TATA") # TATA box یک موتیف در پروموتر است

print("جایگاه کدون شروع:", start_codon_index)
print("جایگاه TATA box:", tata_box_index)
```

**خروجی:**
`جایگاه کدون شروع: 0`
`جایگاه TATA box: 10`

---

### 🔬 تمرین تحلیلی: شناسایی یک جایگاه اتصال (Binding Site)

شما یک توالی DNA کوتاه در اختیار دارید. یک فاکتور رونویسی (Transcription Factor) به دنبال الگوی `GATAAG` در DNA می‌گردد تا به آن متصل شود. با استفاده از ابزارهایی که یاد گرفتید، به سوالات زیر پاسخ دهید.

```python
dna_sequence = "AGGTCCGATAAGCTTAGGAT"
binding_site = "GATAAG"
```

**سوالات:**
۱. طول کل توالی `dna_sequence` چقدر است؟
۲. الگوی `binding_site` در چه جایگاهی (ایندکس) از توالی شروع می‌شود؟
۳. با استفاده از slicing، قطعه مربوط به `binding_site` را از `dna_sequence` استخراج و چاپ کنید.
۴. تعداد بازهای تیمین ('T') در کل توالی `dna_sequence` چقدر است؟

**پاسخ و راه حل:**

```python
# تعریف متغیرها
dna_sequence = "AGGTCCGATAAGCTTAGGAT"
binding_site = "GATAAG"

# ۱. محاسبه طول
length = len(dna_sequence)
print(f"طول کل توالی: {length}")

# ۲. پیدا کردن جایگاه شروع
start_index = dna_sequence.find(binding_site)
print(f"جایگاه شروع سایت اتصال: {start_index}")

# ۳. استخراج قطعه
# طول سایت اتصال 6 است، پس قطعه از start_index تا start_index + 6 خواهد بود
extracted_site = dna_sequence[start_index : start_index + len(binding_site)]
print(f"قطعه استخراج شده: {extracted_site}")

# ۴. شمارش تعداد تیمین
t_count = dna_sequence.count('T')
print(f"تعداد باز تیمین: {t_count}")
```

### 💡 نکات کلیدی این بخش

- **رشته‌ها (Strings)** در پایتون، نمایش دیجیتالی توالی‌های زیستی هستند.
- شماره‌گذاری در رشته‌ها از **صفر** شروع می‌شود (Zero-based indexing).
- تابع `len()` طول یک رشته را برمی‌گرداند.
- **Indexing** (`dna[0]`) برای دسترسی به یک کاراکتر واحد استفاده می‌شود.
- **Slicing** (`dna[4:10]`) برای استخراج یک زیررشته (substring) به کار می‌رود.
- عملگر `+` برای **چسباندن (Concatenation)** دو رشته استفاده می‌شود.
- متد `.count()` تعداد تکرار یک کاراکتر یا الگو را می‌شمارد.
- متد `.find()` جایگاه شروع یک الگو را پیدا می‌کند.

با همین چند ابزار ساده، شما اکنون توانایی انجام تحلیل‌های پایه‌ای بر روی توالی‌های زیستی را دارید. در بخش بعد، با معرفی منطق شرطی، قدرت ما برای تصمیم‌گیری بر اساس این داده‌ها بسیار بیشتر خواهد شد.
