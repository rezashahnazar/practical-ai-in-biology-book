[← سناریو ۲: سوالات](./scenario-02-questions.md) | [سناریو ۳: سوالات →](./scenario-03-questions.md)

# آزمون فصل ۴: سناریو ۲ - پاسخنامه و تحلیل (مولد مکمل معکوس)

در این بخش، کد کامل برای ساخت مولد مکمل معکوس به همراه توضیحات گام به گام ارائه می‌شود تا با منطق پشت پیاده‌سازی این ابزار کلیدی در بیوانفورماتیک آشنا شوید.

### کد کامل راه‌حل

```python
# تعریف توالی ورودی
dna_sequence = "AGTCGATCGATAGCTAGCTAG"

# -----------------------------------------------------
# قدم ۱: مقداردهی اولیه متغیرها
# -----------------------------------------------------
# یک رشته خالی برای ذخیره کردن توالی مکمل
complement_sequence = ""

# -----------------------------------------------------
# قدم ۲: ساختن رشته مکمل
# -----------------------------------------------------
# با یک حلقه for، بر روی هر باز در توالی اصلی حرکت می‌کنیم
for base in dna_sequence.upper():
    if base == 'A':
        complement_sequence += 'T' # به انتهای رشته مکمل، 'T' را اضافه کن
    elif base == 'T':
        complement_sequence += 'A'
    elif base == 'C':
        complement_sequence += 'G'
    elif base == 'G':
        complement_sequence += 'C'
    else:
        # (اختیاری) اگر کاراکتر نامعتبر بود، همان را اضافه می‌کنیم
        complement_sequence += base

# -----------------------------------------------------
# قدم ۳: معکوس کردن رشته مکمل
# -----------------------------------------------------
# با استفاده از تکنیک اسلایسینگ، رشته مکمل را به سادگی معکوس می‌کنیم
reverse_complement_sequence = complement_sequence[::-1]

# -----------------------------------------------------
# قدم ۴: چاپ خروجی در فرمت خواسته‌شده
# -----------------------------------------------------
# برای خوانایی بهتر، جهت رشته‌ها را با '5 و '3 مشخص می‌کنیم
print(f"توالی اصلی:        5'-{dna_sequence}-3'")
print(f"رشته مکمل:        3'-{complement_sequence}-5'")
print(f"مکمل معکوس نهایی: 5'-{reverse_complement_sequence}-3'")

```

### تحلیل و توضیح کد

#### قدم ۱: مقداردهی اولیه

- `dna_sequence`: متغیر حاوی رشته DNA ورودی ما.
- `complement_sequence = ""`: ما یک **رشته خالی** ایجاد می‌کنیم. این متغیر مانند یک بوم خالی است که ما در مرحله بعد، بازهای مکمل را یکی یکی به انتهای آن اضافه خواهیم کرد.

#### قدم ۲: ساختن رشته مکمل

- **حلقه `for`:** این حلقه، هر کاراکتر (باز) از `dna_sequence` را به ترتیب پیمایش می‌کند. ما مجدداً از `.upper()` استفاده می‌کنیم تا کد ما نسبت به بزرگی و کوچکی حروف مقاوم باشد.
- **بلوک `if/elif`:** این بلوک منطق اصلی مکمل‌یابی است.
  - برای هر باز، ما باز مکمل آن را با استفاده از عملگر `+=` به **انتهای** رشته `complement_sequence` "می‌چسبانیم" یا الحاق (append/concatenate) می‌کنیم.
  - برای مثال، وقتی حلقه به `A` می‌رسد، `T` به انتهای `complement_sequence` اضافه می‌شود. وقتی به `G` می‌رسد، `C` اضافه می‌شود و الی آخر.
- **بلوک `else`:** هرچند در صورت مسئله اشاره‌ای به کاراکترهای نامعتبر نشده بود، اما در یک برنامه واقعی، بهتر است همیشه حالت‌های پیش‌بینی نشده را مدیریت کرد. در اینجا، اگر کاراکتری غیر از A, T, C, G وجود داشت، ما همان کاراکتر را به رشته مکمل اضافه می‌کنیم.

#### قدم ۳: معکوس کردن رشته مکمل

- `reverse_complement_sequence = complement_sequence[::-1]`
- این خط، یکی از زیباترین و قدرتمندترین ویژگی‌های پایتون برای کار با رشته‌ها را به نمایش می‌گذارد: **اسلایسینگ (Slicing)**.
- سینتکس `[start:stop:step]` برای برش دادن رشته‌ها استفاده می‌شود.
- وقتی `start` و `stop` را خالی می‌گذاریم و `step` را برابر با `-1` قرار می‌دهیم، به پایتون می‌گوییم: "از ابتدا تا انتهای رشته حرکت کن، اما با قدم‌های منفی یک". این کار عملاً کل رشته را از انتها به ابتدا می‌خواند و در نتیجه آن را **معکوس** می‌کند.
- این روش بسیار کارآمدتر و خواناتر از نوشتن یک حلقه `for` برای معکوس کردن دستی رشته است.

#### قدم ۴: چاپ خروجی

- در نهایت، با استفاده از f-string ها، هر سه رشته (اصلی، مکمل و مکمل معکوس) را با فرمت‌بندی مناسب چاپ می‌کنیم.
- افزودن `5'-` و `-3'` به ابتدا و انتهای رشته‌ها در هنگام چاپ، یک قرارداد رایج در بیوانفورماتیک برای نشان دادن **جهت‌گیری (Directionality)** رشته‌های اسید نوکلئیک است و به خوانایی و درک بیولوژیکی خروجی کمک شایانی می‌کند.
