# فصل ۶: مباحث پیشرفته و کاربردهای دنیای واقعی

## بخش ۶-۵: پروژه: پیش‌بینی پایداری پروتئین

[← بخش ۶-۴: اخلاق در هوش مصنوعی زیستی: فراتر از کد](./04-ethics-in-bio-ai.md) | [آزمون فصل ششم →](./exam/index.md)

برای آخرین پروژه این کتاب، ما به سراغ یک مسئله رگرسیون کلاسیک و بسیار مهم در بیوانفورماتیک می‌رویم: پیش‌بینی پایداری یک پروتئین. پایداری یک پروتئین، که اغلب با "دمای ذوب" (Tm) آن اندازه‌گیری می‌شود، یک ویژگی حیاتی در تولید داروها و آنزیم‌های صنعتی است. در این پروژه، ما تمام مهارت‌های خود را در زمینه رگرسیون به کار می‌گیریم تا مدلی بسازیم که بتواند این شاخص کلیدی پایداری را پیش‌بینی کند.

### 🎯 مسئله محوری: چگونه می‌توانیم با استفاده از هوش مصنوعی، پروتئین‌های پایدارتر و کارآمدتر طراحی کنیم؟

در دنیای بیوتکنولوژی، پایداری یک پروتئین همه چیز است. یک داروی پروتئینی یا یک آنزیم صنعتی اگر در دمای بدن یا شرایط فرآیند به سرعت ساختار خود را از دست بدهد، بی‌فایده است. آیا می‌توانیم قبل از صرف هزینه و زمان زیاد برای ساختن یک پروتئین در آزمایشگاه، پایداری آن را صرفاً از روی توالی اسیدهای آمینه‌اش پیش‌بینی کنیم؟ این پروژه، دروازه‌ای به سوی دنیای مهندسی پروتئین و طراحی هوشمند مولکول‌های زیستی است.

---

### اسکریپت کامل در Google Colab

کد زیر یک گردش کار کامل برای حل این مسئله رگرسیون است. آن را در یک نوت‌بوک Colab کپی کرده و اجرا کنید تا ببینید چگونه می‌توانیم پایداری پروتئین را پیش‌بینی کنیم.

```python
# ===================================================================
# مرحله ۱: وارد کردن کتابخانه‌های مورد نیاز
# ===================================================================
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.ensemble import RandomForestRegressor # یک مدل قدرتمندتر
from sklearn.metrics import mean_absolute_error, mean_squared_error
import io

# ===================================================================
# مرحله ۲: آماده‌سازی داده‌ها (شبیه‌سازی داده‌های واقعی)
# ===================================================================
# ویژگی‌ها: درصد اسیدهای آمینه آبگریز، قطبی و باردار
# هدف: دمای ذوب (Tm) بر حسب درجه سانتی‌گراد
data = {
    'percent_hydrophobic': [45, 50, 55, 40, 60, 65, 35, 58, 48, 62],
    'percent_polar': [35, 30, 25, 40, 20, 15, 45, 22, 32, 18],
    'percent_charged': [20, 20, 20, 20, 20, 20, 20, 20, 20, 20],
    'melting_temperature': [65.1, 68.7, 72.3, 62.5, 75.1, 78.9, 60.2, 74.0, 67.5, 76.8]
}
df_proteins = pd.DataFrame(data)

print("--- داده‌های اولیه پروتئین‌ها ---")
print(df_proteins)
print("\n")

# ===================================================================
# مرحله ۳: جداسازی ویژگی‌ها (X) و هدف (y)
# ===================================================================
X = df_proteins[['percent_hydrophobic', 'percent_polar', 'percent_charged']]
y = df_proteins['melting_temperature']

# ===================================================================
# مرحله ۴: تقسیم داده‌ها به مجموعه آموزش و آزمون
# ===================================================================
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)

# ===================================================================
# مرحله ۵: ساخت، آموزش و پیش‌بینی با مدل رگرسیون
# ===================================================================
# مدل جنگل تصادفی معمولاً برای روابط غیرخطی قدرتمندتر است.
model = RandomForestRegressor(n_estimators=100, random_state=42)
model.fit(X_train, y_train)
predictions = model.predict(X_test)

print("--- پیش‌بینی‌های مدل ---")
print("دمای واقعی (y_test):\t", np.round(y_test.values, 2))
print("دمای پیش‌بینی‌شده:\t", np.round(predictions, 2))
print("\n")

# ===================================================================
# مرحله ۶: ارزیابی عملکرد مدل
# ===================================================================
mae = mean_absolute_error(y_test, predictions)
mse = mean_squared_error(y_test, predictions)
print("--- ارزیابی مدل ---")
print(f"میانگین قدرمطلق خطا (MAE): {mae:.2f}°C")
print(f"میانگین مربعات خطا (MSE): {mse:.2f}")
print("\n")

# رسم نمودار مقایسه مقادیر واقعی و پیش‌بینی‌شده
plt.figure(figsize=(7, 7))
plt.scatter(y_test, predictions, alpha=0.7, edgecolors='k', s=100)
plt.plot([min(y_test), max(y_test)], [min(y_test), max(y_test)], '--', color='red', lw=2)
plt.xlabel('دمای ذوب واقعی (Actual Tm)')
plt.ylabel('دمای ذوب پیش‌بینی‌شده (Predicted Tm)')
plt.title('مقایسه مقادیر واقعی و پیش‌بینی‌شده')
plt.grid(True)
plt.show()
```

### تفسیر نتایج

1.  **معیارهای خطا (MAE و MSE):** این اعداد به ما یک سنجش کمی از میزان خطای مدل می‌دهند. به عنوان مثال، MAE به ما می‌گوید که مدل به طور متوسط دمای ذوب پروتئین‌ها را با چه میزان خطایی (بر حسب درجه سانتی‌گراد) پیش‌بینی می‌کند.
2.  **نمودار پراکندگی (Scatter Plot):** این نمودار یک راه عالی برای ارزیابی بصری مدل است. هرچه نقاط به خط قرمز (`y=x`) نزدیک‌تر باشند، یعنی مدل ما بهتر عمل کرده است.

---

### 🔬 تمرین تحلیلی: مهندسی ویژگی و مقایسه مدل

شما اکنون گردش کار کامل برای حل یک مسئله رگرسیون را در اختیار دارید. به عنوان آخرین چالش، مهارت‌های خود را در مهندسی ویژگی و مقایسه مدل‌ها بیازمایید.

**وظایف:**

1.  **مقایسه مدل:** مدل `RandomForestRegressor` را با `LinearRegression` جایگزین کنید (کافی است خط مربوط به `model = ...` را تغییر دهید). معیارهای خطا (MAE و MSE) چه تغییری می‌کنند؟ نمودار پراکندگی را برای مدل جدید تحلیل کنید. آیا رگرسیون خطی برای این داده‌ها مدل بهتری است؟
2.  **مهندسی ویژگی:** یک ویژگی جدید به دیتافریم اضافه کنید. این ویژگی می‌تواند نسبت `percent_hydrophobic` به `percent_polar` باشد. کد زیر را برای ساخت این ویژگی به اسکریپت خود اضافه کنید:
    ```python
    df_proteins['hydro_polar_ratio'] = df_proteins['percent_hydrophobic'] / df_proteins['percent_polar']
    ```
    سپس این ستون جدید را به لیست ویژگی‌های `X` اضافه کرده و هر دو مدل (`LinearRegression` و `RandomForestRegressor`) را دوباره با این ویژگی جدید آموزش دهید. آیا عملکرد هیچ‌کدام از مدل‌ها بهبود یافت؟

### 💡 نکات کلیدی این بخش

- **کاربرد رگرسیون:** از مدل‌های رگرسیون برای پیش‌بینی مقادیر پیوسته مانند پایداری پروتئین (Tm)، فشار خون یا غلظت یک ماده استفاده می‌شود.
- **ارزیابی بصری:** نمودار پراکندگی مقادیر واقعی در برابر مقادیر پیش‌بینی‌شده، یک ابزار قدرتمند برای درک سریع عملکرد یک مدل رگرسیون است.
- **مقایسه مدل‌ها:** هیچ مدلی وجود ندارد که برای همه مسائل بهترین باشد. همیشه مدل‌های مختلف را امتحان کنید و عملکرد آنها را با معیارهای مناسب مقایسه کنید.
- **مهندسی ویژگی (Feature Engineering):** ایجاد ویژگی‌های جدید از داده‌های موجود (مانند محاسبه نسبت‌ها) گاهی اوقات می‌تواند به طور قابل توجهی عملکرد مدل را بهبود بخشد.

تبریک می‌گوییم! شما با موفقیت سفر خود را در دنیای هوش مصنوعی در زیست‌شناسی به پایان رساندید. شما اکنون مهارت‌های اساسی برای خواندن داده‌ها، پردازش آنها، ساخت مدل‌های پیش‌بینی‌کننده و ارزیابی عملکرد آنها را در اختیار دارید.
